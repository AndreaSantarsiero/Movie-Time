<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <title>Movie Time</title>
    <script type="module" src="popup.js"></script>
    <link rel="stylesheet" href="popup.css" />
  </head>


  <body>
    <button id="btn-back" class="mt-back-button" style="display:none">
      â† Back
    </button>
    <header class="mt-header">
      <h1 class="mt-title">
        <img src="logo.png" alt="Movie Time" class="mt-logo" />
      </h1>
    </header>

    <!-- Step 0: scelta iniziale -->
    <div id="step-choice">
      <button id="btn-test">ğŸ§ª Test Connection</button>
      <button id="choose-create">ğŸ¬ Create Session</button>
      <button id="choose-connect">ğŸ”— Connect to Session</button>
    </div>

    <!-- Step 1a: creare sessione -->
    <div id="step-create" style="display:none">
      <button id="btn-create">Generate Offer</button>

      <textarea id="offer" placeholder="Copy this key and send it"></textarea>
      <div class="mt-field-tools">
        <button id="btn-copy-offer" class="mt-mini-button" type="button">
          Copy
        </button>
      </div>

      <textarea id="answer" placeholder="Paste the answer here"></textarea>
      <div class="mt-field-tools">
        <button id="btn-paste-answer" class="mt-mini-button" type="button">
          Paste
        </button>
      </div>

      <button id="btn-connect">Connect</button>
    </div>

    <!-- Step 1b: connettersi a sessione esistente -->
    <div id="step-join" style="display:none">
      <textarea id="incoming-offer" placeholder="Paste the offer here"></textarea>
      <div class="mt-field-tools">
        <button id="btn-paste-incoming-offer" class="mt-mini-button" type="button">
          Paste
        </button>
      </div>

      <button id="btn-generate-answer">Generate Answer</button>

      <textarea id="answer-for-peer" placeholder="Send this answer back"></textarea>
      <div class="mt-field-tools">
        <button id="btn-copy-answer-for-peer" class="mt-mini-button" type="button">
          Copy
        </button>
      </div>
    </div>

    <div id="status">Ready</div>

    <div class="mt-tip">
      Tip: For best results, use a home Wi-Fi network. Mobile data (4G/5G) and company Wi-Fi often block p2p connections and can make the session fail.
    </div>

    <!-- Custom Error Modal -->
    <div id="error-modal" class="mt-modal" style="display: none;">
      <div class="mt-modal-content">
        <h3 class="mt-modal-title">Notice</h3>
        <p id="error-modal-text"></p>
        <button id="error-modal-ok">OK</button>
      </div>
    </div>
  </body>
</html>
